function color_for_value(val){var color_range=["#CCFFFF","#99CCCC","#669999","#336666","#003333"],counts=_.sortBy(_.uniq(_.values(ward_signups)),function(a){return a});return 0==counts[0]&&counts.shift(),index_of_val=_.indexOf(counts,val),color_index=Math.floor(index_of_val/counts.length*color_range.length),color_range[color_index]}function doMap(){layer=ward_map.getLayer("chicago");for(ward in ward_signups){var path=layer.getPaths({ward:ward}),node=path[0].svgPath.node;jQuery.data(node,"signups",ward_signups[path[0].data.ward]),jQuery.data(node,"ward",path[0].data.ward)}ward_map.getLayer("chicago").style({fill:function(d){return 0==ward_signups[d.ward]?"#fff":color_for_value(ward_signups[d.ward])}});var hover_color="#ccc";$("path.chicago").each(function(idx,obj){$(obj).bind("mouseenter",function(){$(obj).data("previous-fill-color",$(obj).attr("fill")),$(obj).attr("fill",hover_color)}),$(obj).bind("mouseleave",function(){$(obj).attr("fill",$(obj).data("previous-fill-color"))});var number_of_signups=$.data(obj,"signups");$(obj).tooltip({container:"body",animation:!1,placement:"left",title:"Ward "+$.data(obj,"ward")+": "+(number_of_signups||"0")+" tester"+(1==number_of_signups?"":"s")})})}var ward_map,ward_signups;$(document).ready(function(){0!=$("html.lt-ie9").length?($("#ward-map-container").remove(),$("#main-body-copy").removeClass("span6").addClass("span12")):$.get("assets/js/signups.json",function(data){ward_signups=data,ward_map=$K.map("#ward-map"),ward_map.loadMap("assets/img/wards.svg",function(){ward_map.addLayer("chicago",{styles:{"stroke-width":"0.75px",fill:"#fff"}}),doMap()})})});